<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>관리자 - 포인트 충전 관리</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <style>
      body {
        background-color: #1a1a2e;
        min-height: 100vh;
        color: #fff;
      }
      .navbar {
        background-color: #16213e !important;
      }
      .sidebar {
        background-color: #16213e;
        min-height: calc(100vh - 56px);
        padding-top: 20px;
      }
      .sidebar .nav-link {
        color: #adb5bd;
        padding: 15px 20px;
        border-radius: 10px;
        margin: 5px 10px;
      }
      .sidebar .nav-link:hover {
        background-color: #0f3460;
        color: #fff;
      }
      .sidebar .nav-link.active {
        background-color: #e94560;
        color: #fff;
      }
      .content-area {
        padding: 30px;
      }
      .table {
        color: #fff;
      }
      .table thead {
        background-color: #0f3460;
      }
      .table tbody tr {
        background-color: #1b1b3a;
      }
      .table tbody tr:nth-child(even) {
        background-color: #222242;
      }
    </style>
  </head>
  <body>
    <!-- 네비게이션 -->
    <nav class="navbar navbar-expand-lg navbar-dark">
      <div class="container-fluid">
        <a class="navbar-brand" th:href="@{/admin}">BookBuddy Admin</a>
        <div class="navbar-nav ms-auto">
          <span class="nav-link text-light">master님</span>
          <a class="nav-link" th:href="@{/admin/logout}">로그아웃</a>
        </div>
      </div>
    </nav>

    <div class="container-fluid">
      <div class="row">
        <!-- 사이드바 -->
        <div class="col-md-2 sidebar">
          <nav class="nav flex-column">
            <a class="nav-link" th:href="@{/admin/point-refund}">
              포인트 환급
            </a>
            <a class="nav-link active" th:href="@{/admin/point-charge}">
              포인트 충전 관리
            </a>
            <a class="nav-link" th:href="@{/admin/members}"> 회원목록 조회 </a>
            <a class="nav-link" th:href="@{/admin/reports}"> 신고 처리 </a>
            <a class="nav-link" th:href="@{/admin/admins}"> 관리자 추가 </a>
          </nav>
        </div>

        <!-- 메인 컨텐츠 -->
        <div class="col-md-10 content-area">
          <h4>포인트 충전 신청 목록</h4>
          <p class="text-muted">
            이용자가 입금 후 신청한 충전 내역입니다. 입금 확인 후 지급 버튼을
            눌러 포인트를 지급하세요.
          </p>

          <div th:if="${#lists.isEmpty(chargeRequests)}" class="mt-4">
            <p class="text-muted">대기 중인 충전 신청이 없습니다.</p>
          </div>

          <div th:unless="${#lists.isEmpty(chargeRequests)}" class="mt-4">
            <table class="table table-hover align-middle">
              <thead>
                <tr>
                  <th scope="col">ID</th>
                  <th scope="col">회원</th>
                  <th scope="col">충전 포인트</th>
                  <th scope="col">신청일</th>
                  <th scope="col">상태</th>
                  <th scope="col">처리</th>
                </tr>
              </thead>
              <tbody>
                <tr th:each="req : ${chargeRequests}">
                  <td th:text="${req.id}">1</td>
                  <td>
                    <!-- <span th:text="${req.member.nickname}">닉네임</span> 코드에 닉네임 못받음일단 이메일만으로 하기 -->
                    <span th:text="${req.member.loginId}">loginId</span>
                  </td>
                  <td th:text="${req.amount} + ' P'">1000 P</td>
                  <td
                    th:text="${#temporals.format(req.requestedAt, 'yyyy-MM-dd HH:mm')}"
                  >
                    2025-01-01 12:00
                  </td>
                  <td th:text="${req.status}">PENDING</td>
                  <td>
                    <form
                      th:action="@{'/admin/point-charge/' + ${req.id} + '/approve'}"
                      method="post"
                      class="d-inline"
                    >
                      <button type="submit" class="btn btn-sm btn-success">
                        지급
                      </button>
                    </form>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
