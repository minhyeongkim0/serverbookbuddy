<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ê´€ë¦¬ì - íšŒì› ê´€ë¦¬</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <style>
      /* Admin Dark Theme ê³µí†µ ìŠ¤íƒ€ì¼ */
      body {
        background-color: #1a1a2e;
        min-height: 100vh;
        color: #fff;
      }
      .navbar {
        background-color: #16213e !important;
      }
      .sidebar {
        background-color: #16213e;
        min-height: calc(100vh - 56px);
        padding-top: 20px;
      }
      .sidebar .nav-link {
        color: #adb5bd;
        padding: 15px 20px;
        border-radius: 10px;
        margin: 5px 10px;
        transition: all 0.2s;
      }
      .sidebar .nav-link:hover {
        background-color: #0f3460;
        color: #fff;
      }
      .sidebar .nav-link.active {
        background-color: #e94560;
        color: #fff;
        font-weight: bold;
      }
      .content-area {
        padding: 30px;
      }

      /* ê²€ìƒ‰ì°½ ìŠ¤íƒ€ì¼ */
      .search-input {
        background-color: #16213e;
        border: 1px solid #0f3460;
        color: #fff;
      }
      .search-input:focus {
        background-color: #16213e;
        border-color: #e94560;
        color: #fff;
        box-shadow: none;
      }
      .search-input::placeholder {
        color: #6c757d;
      }

      /* í…Œì´ë¸” ìŠ¤íƒ€ì¼ */
      .table {
        color: #fff;
        margin-top: 20px;
      }
      .table thead {
        background-color: #0f3460;
      }
      .table thead th {
        border-bottom: none;
        padding: 15px;
      }
      .table tbody tr {
        background-color: #1b1b3a;
        border-bottom: 1px solid #2d2d4e;
      }
      .table tbody tr:hover {
        background-color: #222242;
      }
      .table tbody td {
        padding: 15px;
        vertical-align: middle;
        border-bottom: none;
      }
    </style>
  </head>
  <body>
    <!-- ë„¤ë¹„ê²Œì´ì…˜ ë°” -->
    <nav class="navbar navbar-expand-lg navbar-dark">
      <div class="container-fluid">
        <a class="navbar-brand fw-bold" th:href="@{/admin}">BookBuddy Admin</a>
        <div class="navbar-nav ms-auto">
          <span class="nav-link text-light">masterë‹˜</span>
          <a class="nav-link" th:href="@{/admin/logout}">ë¡œê·¸ì•„ì›ƒ</a>
        </div>
      </div>
    </nav>

    <div class="container-fluid">
      <div class="row">
        <!-- ì‚¬ì´ë“œë°” -->
        <div class="col-md-2 sidebar">
          <nav class="nav flex-column">
            <a class="nav-link" th:href="@{/admin/point-refund}">
              í¬ì¸íŠ¸ í™˜ê¸‰
            </a>
            <a class="nav-link" th:href="@{/admin/point-charge}">
              í¬ì¸íŠ¸ ì¶©ì „ ê´€ë¦¬
            </a>
            <!-- í˜„ì¬ í˜ì´ì§€ í™œì„±í™” (active í´ë˜ìŠ¤) -->
            <a class="nav-link active" th:href="@{/admin/members}">
              íšŒì›ëª©ë¡ ì¡°íšŒ
            </a>
            <a class="nav-link" th:href="@{/admin/reports}"> ì‹ ê³  ì²˜ë¦¬ </a>
            <a class="nav-link" th:href="@{/admin/admins}"> ê´€ë¦¬ì ì¶”ê°€ </a>
          </nav>
        </div>

        <!-- ë©”ì¸ ì»¨í…ì¸  -->
        <div class="col-md-10 content-area">
          <div class="d-flex justify-content-between align-items-center mb-4">
            <div>
              <h4>ğŸ‘¥ íšŒì› ê´€ë¦¬</h4>
              <p class="text-muted mb-0">
                ì „ì²´ íšŒì› ëª©ë¡ì„ ì¡°íšŒí•˜ê³ , ë¶€ì ì ˆí•œ íšŒì›ì„ ê°•ì œ íƒˆí‡´ì‹œí‚¬ ìˆ˜
                ìˆìŠµë‹ˆë‹¤.
              </p>
            </div>

            <!-- ê²€ìƒ‰ í¼ -->
            <form
              class="d-flex"
              th:action="@{/admin/members}"
              method="get"
              style="width: 300px"
            >
              <div class="input-group">
                <input
                  class="form-control search-input"
                  type="search"
                  name="keyword"
                  th:value="${keyword}"
                  placeholder="íšŒì› ì•„ì´ë”” ê²€ìƒ‰"
                  aria-label="Search"
                />
                <button class="btn btn-primary" type="submit">ê²€ìƒ‰</button>
              </div>
            </form>
          </div>

          <!-- íšŒì› ëª©ë¡ í…Œì´ë¸” -->
          <div class="table-responsive">
            <table class="table align-middle">
              <thead>
                <tr>
                  <th scope="col" style="width: 5%">ID</th>
                  <th scope="col" style="width: 15%">ì•„ì´ë””</th>
                  <th scope="col" style="width: 20%">ì´ë©”ì¼</th>
                  <th scope="col" style="width: 15%">í•™ê³¼</th>
                  <th scope="col" style="width: 10%">í•™ë²ˆ</th>
                  <th scope="col" style="width: 10%">í¬ì¸íŠ¸</th>
                  <th scope="col" style="width: 10%">ìƒíƒœ</th>
                  <th scope="col" style="width: 15%">ê´€ë¦¬</th>
                </tr>
              </thead>
              <tbody>
                <!-- ë°ì´í„°ê°€ ì—†ì„ ê²½ìš° -->
                <tr th:if="${#lists.isEmpty(members)}">
                  <td colspan="8" class="text-center py-5 text-muted">
                    ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.
                  </td>
                </tr>

                <!-- ë°ì´í„° ë°˜ë³µ ì¶œë ¥ -->
                <tr th:each="member : ${members}">
                  <td th:text="${member.id}">1</td>
                  <td>
                    <strong th:text="${member.loginId}">user1</strong>
                  </td>
                  <td th:text="${member.email}">user@ynu.ac.kr</td>
                  <td th:text="${member.department}">ì»´í“¨í„°ê³µí•™ê³¼</td>
                  <td th:text="${member.studentId}">20231234</td>
                  <td>
                    <span
                      class="text-info fw-bold"
                      th:text="${#numbers.formatInteger(member.pointBalance, 0, 'COMMA')}"
                      >0</span
                    >
                    P
                  </td>
                  <td>
                    <!-- ìƒíƒœë³„ ë±ƒì§€ í‘œì‹œ (Null ì•ˆì „ ì²˜ë¦¬) -->
                    <span
                      class="badge bg-success"
                      th:if="${member.status != null and member.status.name() == 'ACTIVE'}"
                      >ì •ìƒ</span
                    >
                    <span
                      class="badge bg-warning text-dark"
                      th:if="${member.status != null and member.status.name() == 'LOCKED'}"
                      >ì ê¸ˆ</span
                    >
                    <span
                      class="badge bg-danger"
                      th:if="${member.status != null and member.status.name() == 'BANNED'}"
                      >ê°•í‡´ë¨</span
                    >
                    <!-- statusê°€ nullì¼ ê²½ìš° -->
                    <span
                      class="badge bg-secondary"
                      th:if="${member.status == null}"
                      >ì•Œìˆ˜ì—†ìŒ</span
                    >
                  </td>
                  <td>
                    <!-- ê°•í‡´ ë²„íŠ¼: statusê°€ nullì´ê±°ë‚˜ BANNEDê°€ ì•„ë‹ ë•Œ ë…¸ì¶œ -->
                    <form
                      th:if="${member.status == null or member.status.name() != 'BANNED'}"
                      th:action="@{'/admin/members/' + ${member.id} + '/ban'}"
                      method="post"
                      class="d-inline"
                      onsubmit="return confirm('ì •ë§ ì´ íšŒì›ì„ ê°•ì œ íƒˆí‡´ì‹œí‚¤ê² ìŠµë‹ˆê¹Œ?\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');"
                    >
                      <button
                        type="submit"
                        class="btn btn-sm btn-outline-danger"
                      >
                        ê°•ì œ íƒˆí‡´
                      </button>
                    </form>

                    <!-- ê°•í‡´ëœ ìƒíƒœì¼ ë•Œ í‘œì‹œ -->
                    <button
                      th:if="${member.status != null and member.status.name() == 'BANNED'}"
                      class="btn btn-sm btn-secondary"
                      disabled
                    >
                      ì²˜ë¦¬ì™„ë£Œ
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
